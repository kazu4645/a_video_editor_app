# プロジェクト概要

本プロジェクトは **Windows向けデスクトップ動画編集ソフトウェア** です。

## アーキテクチャ

- UI: C# (.NET 8, WPF, MVVM)
- エンジン: C++（ネイティブDLL）
- 動画処理: FFmpeg
- 連携方式: P/Invoke

UIレイヤーに動画処理ロジックを含めてはいけません。  
重い処理はすべてC++エンジン側で実装してください。

---

# フォルダ構成ルール

プロジェクト構造は必ず以下に従ってください。

/VideoEditor
/UI （C# WPF）
/CoreModels （C# 共有モデルのみ）
/Interop （C# P/Invokeレイヤーのみ）
/VideoEngine （C++ DLLプロジェクト）
/ThirdParty （FFmpeg）


フォルダ間で責務を混在させてはいけません。  
各フォルダは明確に役割を分離してください。

---

# C# ルール

- MVVMパターンを必ず使用すること
- code-behindにビジネスロジックを書かないこと
- UIは常に応答可能な状態を維持すること（async/await必須）
- C#からFFmpegを直接呼び出してはいけない
- すべてのネイティブ呼び出しはInteropレイヤーを経由すること
- UI層に重い処理を書いてはいけない

---

# C++ ルール

- DLLとしてビルドすること
- C形式関数のみエクスポートすること（`extern "C"`を使用）
- C++クラスをDLL境界の外に公開しないこと
- UIロジックをC++に含めないこと
- エンジンは単純なデータ構造（structやプリミティブ型）のみを受け取ること
- エンジン内部の実装詳細はUI側に漏らさないこと

---

# メモリおよびパフォーマンスルール

- メモリリークを発生させないこと
- すべてのネイティブリソースを確実に解放すること
- UIスレッドをブロックしないこと
- 長時間処理は必ずバックグラウンドで実行すること
- 必要に応じてC++エンジン内部でマルチスレッドを使用すること
- 不要なコピー処理を避けること

---

# 機能範囲（MVPのみ）

MVPでサポートする機能は以下のみとします。

1. 動画のトリミング
2. テキストオーバーレイ
3. BGMの挿入
4. 基本フィルター（明るさ調整、グレースケール）
5. MP4形式での書き出し

明示的な指示がない限り、これ以上の高度な機能を実装してはいけません。

---

# コード品質ルール

- 関数は小さく、単一責任を守ること
- モジュール化を意識すること
- 不要な抽象化を避けること
- 明確で分かりやすい命名を行うこと
- コメントは必要最小限にとどめること
- 可読性を最優先とすること
- 設計を勝手に変更しないこと

---

# アーキテクチャ保護ルール

- 明示的な指示がない限り、アーキテクチャを変更してはいけない
- 新しい依存関係を勝手に


---

#　プロジェクトファイルのルール
プロジェクトファイルは基本的に、以下の様な構成イメージにしてください

VideoEditor/
├ .vscode/
│   ├ settings.json
│   ├ launch.json
│   └ tasks.json
├ UI/              ← C# (.NET 8 WPF)
├ CoreModels/      ← C# 共有モデル
├ Interop/         ← C# P/Invoke layer
├ VideoEngine/     ← C++ Engine (CMake project)
├ ThirdParty/      ← FFmpeg libs
└ README.md
